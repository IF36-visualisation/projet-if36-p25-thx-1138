---
title: "Analyse des Jeux Olympiques"
author: "THX1138"
date: "2025-04-23"
output:
  prettydoc::html_pretty:
    theme: architect
    highlight: github
  html_document: default
  pdf_document: default
editor_options:
  markdown:
    wrap: 72
---

## Introduction

Nous sommes des étudiants de l'Université de Technologie de Troyes et
réalisons ce projet dans le cadre de l’UE **IF36** (intitulée :
Visualiser des données). Ce projet nous permet de découvrir et
d’acquérir des compétences en **data visualisation**, ainsi que de
consolider nos connaissances en **R** à travers l’analyse de données
issues des Jeux Olympiques.

L'objectif de notre étude est d’analyser les données des Jeux Olympiques
entre **1896 et 2020** afin d’identifier des tendances et répondre à
différentes questions. Nous nous interrogerons notamment sur l’impact du
pays hôte sur les performances des athlètes nationaux, la répartition
géographique des médaillés ou encore la domination de certains pays dans
des disciplines spécifiques.

------------------------------------------------------------------------

### Données

Pour notre analyse, nous avons sélectionné trois datasets relatifs aux
Jeux Olympiques. Ces derniers sont disponibles sur Kaggle :

#### 1. [**Olympics 124 years Dataset(till 2020)**](https://www.kaggle.com/datasets/nitishsharma01/olympics-124-years-datasettill-2020)

##### Nombre d'observations et de variables

Le dataset contient **environ 238 000 observations** et **13
variables**. Chaque ligne représente un athlète ayant participé à une
épreuve spécifique lors des Jeux Olympiques d’été entre **1896 et
2020**.

##### Description des variables

-   **Identifiants uniques** :
    -   `ID` : Identifiant unique de l'entrée associant un athlète à une
        épreuve lors d'une session des jeux.
    -   `Name` : Nom de l’athlète
-   **Informations démographiques** :
    -   `Sex` : Sexe de l’athlète (`M` / `F`)
    -   `Age` : Âge de l’athlète (valeurs entre **10 et 97 ans**, avec
        une moyenne de **25,7 ans**)
-   **Données liées au pays** :
    -   `Team` : Nom du pays représenté
    -   `NOC` : Code du Comité National Olympique
-   **Données sur l’édition des JO** :
    -   `Games` : Année et saison des JO (`ex: 2020 Summer`)
    -   `Year` : Année des JO (de **1896 à 2020**)
    -   `Season` : Saison (`Summer` ou `Winter`)
    -   `City` : Ville hôte
-   **Données sportives et résultats** :
    -   `Sport` : Discipline sportive
    -   `Event` : Épreuve spécifique
    -   `Medal` : Type de médaille remportée (`Gold`, `Silver`,
        `Bronze`, ou `None`, dans le dernier cas le champ est simplement
        vide)

On mentionnera également le fichier
[regions.csv](https://github.com/IF36-visualisation/projet-if36-p25-thx-1138/blob/master/data/Olympics_124_years_Dataset/regions.csv)
reprenant le `NOC` et l'associant à la région de ce comité ainsi qu'à
une note éventuelle le concernant. Celui-ci nous permettra
éventuellement d'obtenir des informations complémentaires rendant
certains résultats plus clairs.

##### Origine et pertinence du dataset

Ce dataset provient de **Kaggle** et a été sélectionné pour son
**exhaustivité et sa richesse en informations**, couvrant plus d’un
siècle de compétitions olympiques. Il permet d’analyser : -
**L’évolution des Jeux Olympiques**, du nombre d’athlètes et de pays
participants - **Les performances des nations et des athlètes** - **Les
tendances historiques** influencées par les guerres, boycotts et
changements de règlements - **Les disparités de genre dans le sport
olympique**

Il s’intègre parfaitement dans notre projet sur la **visualisation et
l’analyse des tendances olympiques**.

##### Format et structure des données

Le dataset est en **format CSV**, structuré de manière tabulaire et
exploitable avec des outils de **data science** comme **R (tidyverse,
ggplot2, dplyr)**.

-   **Types de variables** :
    -   **Catégoriques** : `Sex`, `Team`, `NOC`, `Games`, `Season`,
        `City`, `Sport`, `Event`, `Medal`
    -   **Numériques** : `Age`, `Year`
    -   **Identifiants uniques** : `ID`
-   **Données manquantes** :
    -   `Age` : 4 % de valeurs manquantes (≈ 9 189 observations)\
    -   `Medal` : Contient de nombreuses valeurs `None`, représentant
        les athlètes n’ayant pas remporté de médaille.

**Catégories et sous-groupes dans les données**\
Le dataset peut être divisé en plusieurs groupes d’analyse :\
1. **Par saison** : Jeux d’été & jeux d'hiver 2. **Par pays** :
Comparaison des performances via `Team` et `NOC` 3. **Par discipline** :
Étude des sports les plus compétitifs et leur évolution 4. **Par
médaille** : Analyse des athlètes et pays ayant remporté le plus de
médailles 5. **Par période historique** : Impact des guerres, boycotts
et modifications des règles

Ce dataset offre une **opportunité unique d’explorer les tendances des
JO**, aussi bien sur le plan **démographique, sportif que
géopolitique**.

#### 2. [**Summer Olympic Medals 1896 - 2020**](https://www.kaggle.com/datasets/ramontanoeiro/summer-olympic-medals-1986-2020)

##### Nombre d'observations et de variables

Le dataset contient **1344 observations** et **8 variables**. Chaque
ligne représente le nombre de médailles remportées par un pays lors
d’une édition des Jeux Olympiques d’été entre **1896 et 2020**.

##### Description des variables

-   **Informations sur l’édition des JO** :
    -   `Year` : Année des Jeux
    -   `Host_country` : Pays hôte des Jeux
    -   `Host_city` : Ville hôte des Jeux
-   **Données sur les pays participants** :
    -   `Country_Name` : Nom du pays participant
    -   `Country_Code` : Code du pays (ex: USA, FRA, GER)
-   **Données sur les médailles remportées par le pays participant** :
    -   `Gold` : Nombre de médailles d’or remportées
    -   `Silver` : Nombre de médailles d’argent remportées
    -   `Bronze` : Nombre de médailles de bronze remportées

##### Origine et pertinence du dataset

Ce dataset provient de **Kaggle** et se concentre sur la **performance
des pays aux Jeux Olympiques d’été** à travers le nombre de médailles
obtenues. Il est pertinent pour analyser :\
- **L’évolution des performances des pays** sur plus d’un siècle de
compétitions - **Les tendances en matière de domination olympique** et
l’impact des pays hôtes - **L’influence des guerres, boycotts et autres
événements historiques** sur la répartition des médailles - **Les
variations de performances des nations émergentes et puissances
sportives historiques**

Ce dataset s’intègre parfaitement dans un projet de **visualisation et
d’analyse des performances olympiques par pays**.

##### Format et structure des données

Le dataset est en **format CSV**, organisé sous une structure tabulaire
exploitable avec des outils de **data science** comme **R (tidyverse,
ggplot2, dplyr)**.

-   **Types de variables** :
    -   **Catégoriques** : `Host_country`, `Host_city`, `Country_Name`,
        `Country_Code`
    -   **Numériques** : `Year`, `Gold`, `Silver`, `Bronze`
-   **Données manquantes** :
    -   `Country_Code` : 6 % de valeurs manquantes (86 observations)

**Catégories et sous-groupes dans les données**\
Ce dataset peut être segmenté selon plusieurs axes d’analyse :\
1. **Par édition des JO** : Comparaison des performances des pays sur
chaque édition 2. **Par pays** : Évolution des performances d’un pays à
travers les différentes années 3. **Par type de médaille** : Répartition
des médailles d’or, d’argent et de bronze 4. **Par pays hôte** : Étude
de l’impact du pays hôte sur la répartition des médailles 5. **Par
période historique** : Influence des événements géopolitiques sur les
résultats

Ce dataset constitue une **ressource précieuse pour étudier les
performances olympiques des nations** et comprendre **l’évolution des
tendances sportives au fil du temps**.

#### 3. [**Olympics Athlete Events Analysis**](https://www.kaggle.com/datasets/samruddhim/olympics-althlete-events-analysis)

##### Nombre d'observations et de variables

Le dataset contient **environ 271 000 observations** et **15
variables**. Chaque ligne représente un athlète ayant participé à une
épreuve spécifique lors des Jeux Olympiques d'été et d'hiver, depuis
**1896**.

##### Description des variables

-   **Identifiants uniques** :
    -   `ID` : Identifiant unique de l'athlète\
    -   `Name` : Nom de l’athlète
-   **Informations démographiques** :
    -   `Sex` : Sexe de l’athlète (`M` / `F`)\
    -   `Age` : Âge de l’athlète (valeurs entre **10 et 97 ans**, avec
        une moyenne de **25,7 ans**)
-   **Données liées au pays** :
    -   `Team` : Nom du pays représenté\
    -   `NOC` : Code du Comité National Olympique
-   **Données sur l’édition des JO** :
    -   `Games` : Année et saison des JO (`ex: 2020 Summer`)\
    -   `Year` : Année des JO (de **1896 à 2020**)\
    -   `Season` : Saison (`Summer` / `Winter`)\
    -   `City` : Ville hôte
-   **Données sportives et résultats** :
    -   `Sport` : Discipline sportive\
    -   `Event` : Épreuve spécifique\
    -   `Medal` : Type de médaille remportée (`Gold`, `Silver`,
        `Bronze`, ou `None`)

##### Origine et pertinence du dataset

Ce dataset provient de **Kaggle** et a été sélectionné pour son
**exhaustivité et sa richesse en informations**, couvrant plus d’un
siècle de compétitions olympiques. Il permet d’analyser : -
**L’évolution des Jeux Olympiques**, du nombre d’athlètes et de pays
participants - **Les performances des nations et des athlètes** - **Les
tendances historiques** influencées par les guerres, boycotts et
changements de règlements - **Les disparités de genre dans le sport
olympique**

Ce dataset est particulièrement pertinent pour les projets d'**analyse
de données sportives** et peut être utilisé pour la **visualisation** et
l’**analyse des tendances olympiques**.

##### Format et structure des données

Le dataset est en **format CSV**, structuré de manière tabulaire et
exploitable avec des outils de **data science** comme **R (tidyverse,
ggplot2, dplyr)**.

-   **Types de variables** :
    -   **Catégoriques** : `Sex`, `Team`, `NOC`, `Games`, `Season`,
        `City`, `Sport`, `Event`, `Medal`
    -   **Numériques** : `Age`, `Year`
    -   **Identifiants uniques** : `ID`
-   **Données manquantes** :
    -   `Age` : 4 % de valeurs manquantes (≈ 9 189 observations)\
    -   `Medal` : Contient de nombreuses valeurs `None`, représentant
        les athlètes n’ayant pas remporté de médaille.

**Catégories et sous-groupes dans les données**\
Le dataset peut être divisé en plusieurs groupes d’analyse : 1. **Par
saison** : Jeux d’été (`Summer`) et d’hiver (`Winter`) 2. **Par pays** :
Comparaison des performances via `Team` et `NOC` 3. **Par discipline** :
Étude des sports les plus compétitifs et leur évolution 4. **Par
médaille** : Analyse des athlètes et pays ayant remporté le plus de
médailles 5. **Par période historique** : Impact des guerres, boycotts
et modifications des règles

Ce dataset offre une **opportunité unique d’explorer les tendances des
JO**, aussi bien sur le plan **démographique, sportif que
géopolitique**.

------------------------------------------------------------------------

### Plan d’analyse

Voici les questions que nous souhaitons explorer à travers ces données :

-   **Évolution de la participation** : Comment le nombre d'athlètes et
    de pays participants a-t-il évolué au fil des Jeux Olympiques ?
-   **Analyse démographique** : Quelle est la répartition par sexe, âge,
    taille et poids des athlètes au fil du temps et selon les
    disciplines ?
-   **Performance des pays** : Quels pays ont remporté le plus de
    médailles au fil des ans ? Existe-t-il des tendances ou des périodes
    de domination spécifiques ? Le nombre d'habitants est il corrélé
    avec le nombre de médailles ? Y'a-t-il des pays qui ne sont
    performant que dans une catégorie de sport (collectif, combat...) ?
-   **Impact du pays hôte** : Un pays organisateur a-t-il un avantage en
    termes de performances et de médailles remportées lorsqu’il
    accueille les Jeux ? Comment évolue la performance des athlètes
    locaux par rapport aux éditions précédentes et suivantes ? Y'a il un
    impact géographique sur les performances des athlètes (exemple
    :altitude)
-   **Analyse des disciplines sportives** : Quels sports ont été les
    plus compétitifs en termes de nombre de participants et de médailles
    distribuées ?
-   **Corrélations possibles** : Existe-t-il une corrélation entre l'âge
    des athlètes et leur performance dans certaines disciplines ?
-   **Nouveaux sports et épreuves** : Comment l'introduction de
    nouvelles disciplines a-t-elle influencé la diversité des médaillés
    et la participation globale ? Le nombre d'épreuve a-t-il augmenté au
    cours du temps ?
-   **Analyse des villes hôtes** : Y a-t-il une tendance géographique
    dans le choix des villes hôtes au fil des années ?
-   **Performance individuelle** : Quels athlètes ont remporté le plus
    de médailles au cours de leur carrière ?
-   **Disparités de genre** : Comment la participation et la performance
    des femmes aux Jeux Olympiques ont-elles évolué depuis leur
    introduction ?
-   **Effets des boycotts et des conflits** : Quels ont été les impacts
    des boycotts et des guerres sur les Jeux Olympiques en termes de
    participation et de performances des nations concernées ?
-   **Influence économique et politique** : Y a-t-il une relation entre
    le niveau économique d’un pays et son nombre de médailles remportées
    ? Les périodes de tensions politiques ou de crises économiques
    ont-elles eu un impact sur la participation et les performances ?

Pour répondre à ces questions, nous comparerons des variables telles que
le nombre d'athlètes, le nombre de pays participants, le nombre de
médailles remportées, l'âge des athlètes, etc. Nous devrons également
être attentifs aux éventuelles incohérences ou valeurs manquantes dans
les données, ainsi qu'aux changements de catégories ou de disciplines au
fil du temps, qui pourraient compliquer certaines analyses. La
comparabilité entre différentes époques constitue également un enjeu
majeur, car les règlements et les disciplines olympiques ont évolué au
fil du temps, impactant les performances et les classements. De plus,
des événements historiques tels que les boycotts ou les guerres ont
parfois limité la participation de certains pays, ce qui pourrait
biaiser certaines analyses. Il sera donc essentiel de prendre en compte
ces facteurs pour garantir la pertinence et la fiabilité des
conclusions.

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, warning = FALSE)
library(dplyr)
library(ggplot2)
library(readr)
library(tidyverse)
library(shiny)
library(leaflet)
library(sf)
library(rnaturalearth)
library(rnaturalearthdata)
```

## Analyse

## 1. L'effet pays hôte

Dans cette analyse exploratoire, nous cherchons à comprendre si le fait
d'accueillir les Jeux Olympiques d'été procure un avantage aux pays
hôtes.

Nous supposons dès le départ que les pays hôtes des Jeux Olympiques
d'été remporteront un plus grand nombre de médailles, en particulier des
médailles d'or. Cela pourrait être dû à plusieurs facteurs : tout
d'abord, le soutien massif du public local peut offrir un avantage
psychologique aux athlètes, les poussant à surperformer, notamment lors
des épreuves les plus disputées. Ensuite, la familiarité avec
l'environnement et l'absence de problèmes d'acclimatation logistique
peuvent offrir aux athlètes un confort supplémentaire qui se traduit par
de meilleures performances. Enfin, bien que cela soit plus controversé,
l'effet de l'arbitrage pourrait être légèrement influencé par la
pression exercée par la foule et les attentes nationales,
particulièrement dans les finales où les résultats sont souvent plus
serrés.

### Question 1 : Correlation entre pays hotes et nombre de médailles

```{r echo=FALSE, message=FALSE, warning=FALSE}
# Lecture des données
medals <- read_csv("data/Summer Olympic Medals 1896 - 2020/summer_olympic_medals.csv", show_col_types = FALSE)

# Nettoyage rapide : s'assurer qu'il n'y a pas de NA gênants
medals <- medals %>% filter(!is.na(Country_Name))

# Création d'une variable pour savoir si le pays est hôte ou non
medals <- medals %>%
  mutate(Host = ifelse(Country_Name == Host_country, "Host", "Non-host"))

# Agréger les médailles par type d'hôte
host_performance <- medals %>%
  group_by(Host) %>%
  summarise(
    Gold = mean(Gold, na.rm = TRUE),
    Silver = mean(Silver, na.rm = TRUE),
    Bronze = mean(Bronze, na.rm = TRUE),
    Total = mean(Gold + Silver + Bronze, na.rm = TRUE)
  )

# Visualisation
ggplot(host_performance, aes(x = Host, y = Total, fill = Host)) +
  geom_col(width = 0.5) +
  scale_fill_manual(values = c("Host" = "#F8766D", "Non-host" = "#00BFC4")) +
  labs(
    title = "Performance des pays hôtes vs non-hôtes",
    subtitle = "Moyenne du nombre total de médailles remportées",
    x = "Type de pays",
    y = "Nombre moyen de médailles",
    fill = "Pays hôte"
  ) +
  theme_minimal()
```

### Interprétation

Le graphique montre que les pays hôtes remportent en moyenne un nombre
bien plus élevé de médailles que les pays non hôtes lors d'une édition
donnée. Cela confirme notre hypothèse de départ : être pays organisateur
semble conférer un avantage compétitif évident. Toutefois, une question
importante se pose : cet avantage est-il également présent pour toutes
les médailles (or, argent, bronze) ou est-il principalement concentré
sur les médailles d'or ? Comme les finales pour les médailles d’or
attirent souvent une attention médiatique et émotionnelle particulière,
il est plausible que l’effet pays hôte soit particulièrement visible à
ce niveau.

### Question 2 : Distribution par type de médaille

```{r echo=FALSE, message=FALSE, warning=FALSE}
# 1. Chargement des données
medals <- read_csv("data/Summer Olympic Medals 1896 - 2020/summer_olympic_medals.csv", show_col_types = FALSE)

# 2. Création de la variable 'Host_Status'
medals <- medals %>%
  mutate(Host_Status = ifelse(Country_Name == Host_country, "Pays Hôte", "Pays Non-Hôte"))

# 3. Agrégation des médailles par statut du pays hôte et par type de médaille
# Calcul des moyennes pour l'Or, l'Argent et le Bronze
medal_type_means <- medals %>%
  group_by(Host_Status) %>%
  summarise(
    Gold = mean(Gold, na.rm = TRUE),
    Silver = mean(Silver, na.rm = TRUE),
    Bronze = mean(Bronze, na.rm = TRUE),
    .groups = "drop"
  )

# 4. Transformation des données au format "long" pour ggplot
# Cela permet de représenter chaque type de médaille comme une ligne distincte
# pour chaque catégorie (Pays Hôte / Pays Non-Hôte), nécessaire pour les barres groupées.
medal_type_long_plot <- medal_type_means %>%
  pivot_longer(
    cols = c("Gold", "Silver", "Bronze"),
    names_to = "Medal_Type",
    values_to = "Average_Count"
  ) %>%
  mutate(
    Medal_Type = factor(Medal_Type, levels = c("Gold", "Silver", "Bronze"),
                        labels = c("Or", "Argent", "Bronze")) # Labels en français
  )

# 5. Visualisation : Graphique en barres groupées (geom_col avec position = "dodge")
ggplot(medal_type_long_plot, aes(x = Medal_Type, y = Average_Count, fill = Host_Status)) +
  geom_col(position = "dodge", width = 0.7) + # Barres groupées
  geom_text(aes(label = sprintf("%.1f", Average_Count)),
            position = position_dodge(width = 0.7), # Positionnement des labels au-dessus des barres
            vjust = -0.5, size = 3.5) + # Ajustement vertical pour éviter le chevauchement
  scale_fill_manual(values = c("Pays Hôte" = "#F8766D", "Pays Non-Hôte" = "#00BFC4")) + # Couleurs plus distinctes
  labs(
    title = "Distribution moyenne des médailles par type : Pays Hôtes vs Pays Non-Hôtes",
    subtitle = "Nombre moyen de médailles (Or, Argent, Bronze) par catégorie (1896-2020)",
    x = "Type de Médaille",
    y = "Nombre moyen de médailles",
    fill = "Statut du Pays" # Légende du remplissage
  ) +
  theme_minimal(base_size = 12) +
  theme(
    plot.title = element_text(face = "bold", hjust = 0.5), # Titre en gras et centré
    plot.subtitle = element_text(hjust = 0.5), # Sous-titre centré
    legend.position = "bottom", # Position de la légende
    panel.grid.major.x = element_blank() # Enlève les lignes de grille verticales majeures
  ) +
  # Ajustement de l'étendue de l'axe y pour que les labels soient visibles
  coord_cartesian(ylim = c(0, max(medal_type_long_plot$Average_Count, na.rm = TRUE) * 1.15)) # Augmente l'étendue de 15% au-dessus du max

```

### Interprétation

L'avantage du pays hôte est visible pour tous les types de médailles,
avec un effet plus prononcé pour les médailles d'or. Les pays hôtes
remportent en moyenne 4 médailles d'or de plus que d'argent ou de
bronze, tandis que cette distribution est plus équilibrée pour les pays
non-hôtes. Cette légère surreprésentation des médailles d'or confirme
que l'avantage du pays hôte est déterminant dans les moments décisifs
des compétitions


### Question 3: Évolution des médailles entre 4 ans avant et l'année hôte

```{r echo=FALSE, message=FALSE, warning=FALSE}
# 1. Chargement des données et calcul du total des médailles
medals <- read_csv("data/Summer Olympic Medals 1896 - 2020/summer_olympic_medals.csv", show_col_types = FALSE) %>%
  mutate(Total_Medals = Gold + Silver + Bronze)

# 2. Identification des pays hôtes et de leurs performances aux années clés
host_events <- medals %>%
  filter(Country_Name == Host_country) %>%
  distinct(Host_country, Host_city, Year) %>%
  rename(Host_Year = Year)

host_medal_trend_extended <- host_events %>%
  rowwise() %>%
  mutate(
    Medals_12_Years_Before = medals %>% # Médailles 12 ans avant
      filter(Country_Name == Host_country, Year == (Host_Year - 12)) %>%
      pull(Total_Medals) %>%
      first(),
    Medals_8_Years_Before = medals %>% # Médailles 8 ans avant
      filter(Country_Name == Host_country, Year == (Host_Year - 8)) %>%
      pull(Total_Medals) %>%
      first(),
    Medals_4_Years_Before = medals %>% # Médailles 4 ans avant
      filter(Country_Name == Host_country, Year == (Host_Year - 4)) %>%
      pull(Total_Medals) %>%
      first(),
    Medals_Host = medals %>% # Médailles l'année hôte
      filter(Country_Name == Host_country, Year == Host_Year) %>%
      pull(Total_Medals) %>%
      first()
  ) %>%
  ungroup() %>%
  # Filtrer les événements pour lesquels nous n'avons pas de données complètes sur toutes les périodes
  filter(!is.na(Medals_12_Years_Before) &
           !is.na(Medals_8_Years_Before) &
           !is.na(Medals_4_Years_Before) &
           !is.na(Medals_Host)) %>%
  pivot_longer(
    cols = starts_with("Medals_"),
    names_to = "Phase",
    values_to = "Medals",
    names_prefix = "Medals_"
  ) %>%
  mutate(
    # Définir l'ordre et les labels des phases pour le graphique
    Phase = factor(Phase,
                   levels = c("12_Years_Before", "8_Years_Before", "4_Years_Before", "Host"),
                   labels = c("12 ans avant", "8 ans avant", "4 ans avant", "Année Hôte")),
    Host_Label = paste0(Host_country, " (", Host_city, ", ", Host_Year, ")")
  )

# Définir la valeur maximale des médailles pour l'ajustement de l'axe Y
max_medals_value <- max(host_medal_trend_extended$Medals, na.rm = TRUE)

# 3. Visualisation : Graphique en ligne (3 éditions avant vs Hôte)
ggplot(host_medal_trend_extended, aes(x = Phase, y = Medals, group = 1)) + # group = 1 car chaque facette a une seule ligne
  geom_point(size = 3, color = "#00BFC4") + # Couleur fixe pour les points dans chaque facette
  geom_line(linewidth = 1, color = "#00BFC4") + # Couleur fixe pour les lignes dans chaque facette
  labs(
    title = "Évolution des médailles totales des pays hôtes : Tendances avant et pendant l'accueil des JO",
    subtitle = "Performance de chaque pays hôte aux Jeux Olympiques (3 éditions précédentes et Année Hôte)",
    x = "Période relative à l'accueil des Jeux",
    y = "Nombre total de médailles remportées"
  ) +
  facet_wrap(~ Host_Label, scales = "fixed", ncol = 4) + # Utilisation de facet_wrap pour séparer les graphiques
  theme_minimal(base_size = 10) + # Taille de base légèrement réduite pour les facettes
  theme(
    plot.title = element_text(face = "bold", hjust = 0.5, size = 14),
    plot.subtitle = element_text(hjust = 0.5, size = 10),
    axis.text.x = element_text(angle = 45, hjust = 1, size = 8),
    axis.text.y = element_text(size = 8),
    legend.position = "none", # La légende n'est plus nécessaire car chaque graphique est étiqueté par sa facette
    panel.grid.major.x = element_blank(),
    plot.margin = unit(c(0.5, 0.5, 0.5, 0.5), "cm"), # Marges réduites légèrement
    strip.text = element_text(size = 9, face = "bold"), # Taille du texte des titres de facettes
    strip.background = element_rect(fill = "lightgray", color = NA) # Arrière-plan des titres de facettes
  ) +
  geom_text(aes(label = Medals), vjust = -0.5, size = 2.5, show.legend = FALSE) + # Taille des labels numériques ajustée
  coord_cartesian(ylim = c(0, max_medals_value * 1.2)) # Augmente l'étendue de 20% au-dessus du max pour plus d'espace
```

### Interpretation

Initialement, nous avions posé l'hypothèse que les pays hôtes remporteraient un plus grand nombre de médailles, notamment d'or, grâce au soutien du public, à la familiarité avec l'environnement et, potentiellement, à une légère influence sur l'arbitrage. Les observations générales ont confirmé que les pays hôtes remportent en moyenne un nombre de médailles significativement plus élevé.

Nuance de l'effet "boost" immédiat : Au-delà de la simple moyenne
Cependant, cette moyenne générale peut être trompeuse. Le graphique de l'"Évolution des médailles totales des pays hôtes : Tendances avant et pendant l'accueil des JO" nous permet d'observer la performance individuelle de chaque pays hôte sur les trois éditions précédant l'accueil (12, 8 et 4 ans avant) et pendant l'année hôte. Cette granularité révèle une réalité plus complexe et nuance considérablement notre hypothèse initiale d'un "boost" systématique et toujours aussi prononcé.

En effet, si un certain nombre de pays comme la Chine (Beijing, 2008), Etats-unis (Atlanta, 1996) ou le Japon (Tokyo, 2020) affichent clairement un pic de médailles durant l'année où ils ont été hôtes, pour d'autres, cette augmentation est moins spectaculaire ou s'inscrit dans une tendance déjà haussière. Il est crucial de noter que plusieurs pays hôtes étaient déjà des puissances sportives reconnues avant même d'accueillir les Jeux, remportant un nombre élevé de médailles lors des éditions précédentes (par exemple, les États-Unis, la Grande-Bretagne en 1908, ou l'Union Soviétique). Dans ces cas, le fait d'être hôte amplifie probablement une force déjà existante, plutôt que de créer une performance exceptionnelle à partir de rien.

De plus, en observant les trajectoires individuelles, nous constatons que l'effet de "pic immédiat" n'est pas aussi universellement prononcé qu'on pourrait le croire. Si l'on compare strictement le nombre de médailles l'année hôte à la performance 4 ans avant, on constate que le gain n'est pas toujours majeur ou systématique. Cela remet en question l'idée qu'être hôte garantit un bond spectaculaire en termes de médailles pour tous les pays, indépendamment de leur niveau sportif initial. L'effet pays hôte, tel que perçu comme un "coup de pouce" garanti et uniforme, n'est donc pas forcément ce que l'on attendait. Il s'agit plutôt d'un facteur qui peut accentuer une performance existante ou créer un avantage dans des contextes spécifiques, mais sa manifestation varie grandement.

Cette observation nous amène à une question essentielle pour la suite de notre analyse : si l'effet "boost" immédiat est plus nuancé que prévu et souvent lié à une force sportive préexistante, quelle est l'influence de l'accueil des Jeux sur le long terme ? Les investissements massifs en infrastructures, les programmes de développement sportif et l'enthousiasme généré par l'événement parviennent-ils à créer une tendance haussière durable pour le pays hôte ? Nous allons désormais explorer si cet héritage olympique se traduit par une performance sportive accrue sur les éditions futures, et si cela concerne particulièrement les pays qui n'étaient pas forcément des "géants" des médailles avant d'accueillir l'événement. L'objectif sera de déceler d'éventuels seuils ou des schémas de croissance post-olympique.

### Question 4:  Influence après avoir été hôte (comparaison des moyennes avant et après); impacte sur le long terme
```{r echo=FALSE, message=FALSE, warning=FALSE}
# --- Étape 3 : Influence après avoir été hôte (comparaison des moyennes avant et après) ---

# Objectif : Évaluer l'impact à long terme de l'accueil des JO en comparant
# la moyenne des médailles remportées par un pays hôte sur plusieurs éditions
# *avant* d'être hôte, et sur plusieurs éditions *après* avoir été hôte.
# Cela permet de voir si l'investissement et les infrastructures ont un effet durable.

# 1. Chargement des données et calcul du total des médailles
medals <- read_csv("data/Summer Olympic Medals 1896 - 2020/summer_olympic_medals.csv", show_col_types = FALSE) %>%
  mutate(Total_Medals = Gold + Silver + Bronze)

# 2. Identifier les pays hôtes et les périodes pertinentes
host_events <- medals %>%
  filter(Country_Name == Host_country) %>%
  distinct(Host_country, Host_city, Year) %>%
  rename(Host_Year = Year) %>%
  arrange(Host_Year) # S'assurer d'avoir un ordre chronologique

# Créer un dataframe pour stocker les moyennes avant et après pour chaque pays hôte
long_term_impact <- data.frame()

for (i in 1:nrow(host_events)) {
  current_host_country <- host_events$Host_country[i]
  current_host_year <- host_events$Host_Year[i]
  current_host_city <- host_events$Host_city[i]

  # Période AVANT (ex: 4 éditions précédentes, donc 16 ans avant l'année hôte)
  # Exclure l'année hôte elle-même de la période "avant"
  years_before <- seq(current_host_year - 4, current_host_year - (4 * 4), by = -4)
  medals_before <- medals %>%
    filter(Country_Name == current_host_country, Year %in% years_before) %>%
    pull(Total_Medals)

  # Période APRÈS (ex: 4 éditions suivantes, donc 16 ans après l'année hôte)
  # Exclure l'année hôte elle-même de la période "après"
  years_after <- seq(current_host_year + 4, current_host_year + (4 * 4), by = 4)
  medals_after <- medals %>%
    filter(Country_Name == current_host_country, Year %in% years_after) %>%
    pull(Total_Medals)

  # Calculer les moyennes (s'assurer qu'il y a des données)
  mean_before <- ifelse(length(medals_before) > 0, mean(medals_before, na.rm = TRUE), NA)
  mean_after <- ifelse(length(medals_after) > 0, mean(medals_after, na.rm = TRUE), NA)

  # Ajouter à notre dataframe de résultats
  long_term_impact <- bind_rows(long_term_impact,
                                data.frame(
                                  Host_Country = current_host_country,
                                  Host_City = current_host_city,
                                  Host_Year = current_host_year,
                                  Mean_Medals_Before = mean_before,
                                  Mean_Medals_After = mean_after
                                ))
}

# Filtrer les lignes où nous n'avons pas de données complètes (NA)
long_term_impact_filtered <- long_term_impact %>%
  filter(!is.na(Mean_Medals_Before) & !is.na(Mean_Medals_After))

# Transformer en format "long" pour ggplot (pour les barres groupées)
long_term_impact_pivot <- long_term_impact_filtered %>%
  pivot_longer(
    cols = c("Mean_Medals_Before", "Mean_Medals_After"),
    names_to = "Period",
    values_to = "Average_Medals"
  ) %>%
  mutate(
    Period = factor(Period, levels = c("Mean_Medals_Before", "Mean_Medals_After"),
                    labels = c("Moyenne Avant Hôte", "Moyenne Après Hôte")),
    Host_Event_Label = paste0(Host_Country, " (", Host_City, ", ", Host_Year, ")")
  )

# 3. Visualisation : Graphique en barres groupées
ggplot(long_term_impact_pivot, aes(x = Host_Event_Label, y = Average_Medals, fill = Period)) +
  geom_bar(stat = "identity", position = position_dodge(width = 0.8), width = 0.7) +
  labs(
    title = "Impact à long terme de l'accueil des JO : Moyenne des médailles avant et après",
    subtitle = "Comparaison de la moyenne des médailles totales (4 éditions avant vs 4 éditions après l'accueil des JO)",
    x = "Pays Hôte (Ville, Année d'accueil)",
    y = "Moyenne du nombre total de médailles",
    fill = "Période"
  ) +
  scale_fill_manual(values = c("Moyenne Avant Hôte" = "#00BFC4", "Moyenne Après Hôte" = "#F8766D")) + # Couleurs plus distinctes
  theme_minimal(base_size = 12) +
  theme(
    plot.title = element_text(face = "bold", hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    axis.text.x = element_text(angle = 45, hjust = 1, size = 8), # Incliner les labels pour la lisibilité
    legend.position = "bottom",
    panel.grid.major.x = element_blank()
  ) +
  geom_text(aes(label = round(Average_Medals, 1)), # Afficher les moyennes arrondies
            position = position_dodge(width = 0.8),
            vjust = -0.5, size = 3)


```


### Interpretation
Nos analyses précédentes (Question 3) ont montré que le "boost" immédiat de médailles durant l'année où un pays est hôte n'est pas toujours aussi universel ou spectaculaire que l'on aurait pu l'imaginer. En observant les trajectoires individuelles, nous avons constaté que ce pic dépendait souvent de la force sportive préexistante du pays et que le gain n'était pas systématiquement majeur ou radical pour toutes les nations. Cette observation nous a poussé à explorer si l'impact des Jeux se manifestait plutôt sur le long terme.

2. La confirmation d'un effet à long terme, mais fortement lié aux structures existantes :

En examinant le graphique actuel, nous pouvons globalement observer que, pour de nombreux pays, la moyenne des médailles après avoir été hôte est effectivement supérieure à leur moyenne avant d'avoir accueilli les Jeux. Cela suggère qu'il y a bien un impact positif à long terme pour une majorité des nations organisatrices. L'investissement dans les infrastructures, la modernisation des équipements et l'élan national généré par l'organisation des Jeux semblent, dans l'ensemble, contribuer à maintenir, voire à améliorer, le niveau sportif des pays sur la durée.

Cependant, la nuance cruciale réside dans le profil des pays qui bénéficient le plus de cet avantage durable. Le graphique met en lumière que ce sont majoritairement les nations qui possédaient déjà des structures sportives robustes et bien établies avant d'accueillir les Jeux qui parviennent à capitaliser sur cet événement pour maintenir ou accroître leur performance à long terme.

Poursuite de la Croissance pour les "Grands" : Des exemples flagrants sont la Chine (Beijing, 2008), qui passe d'une moyenne de 56.2 à 83 médailles après l'accueil, ou les États-Unis (Los Angeles, 1984) avec une augmentation de 70 à 98.9 médailles. Ces pays étaient déjà des superpuissances sportives avec des programmes nationaux très structurés, des investissements continus dans le sport de haut niveau, et des politiques de détection et de formation des talents bien rodées. L'accueil des JO a pu leur fournir un catalyseur, une opportunité de moderniser et d'optimiser davantage leurs infrastructures et leurs programmes, amplifiant ainsi un succès déjà enraciné.

Un Impact Plus Modéré pour les Nations Moins Établies : Pour d'autres pays, comme la France (Paris, 1900 et 1924), le Canada (Montréal, 1976), ou la Belgique (Anvers, 1920), la moyenne des médailles après l'accueil est très similaire, voire parfois légèrement inférieure, à celle d'avant. Cela indique que pour les nations qui n'avaient pas nécessairement des structures sportives d'élite aussi développées, l'investissement massif ponctuel lié à l'organisation des Jeux n'a pas suffi à créer une amélioration structurelle et durable des performances sportives au niveau élite. Les infrastructures construites peuvent servir à la population et au sport de masse, mais cela ne se traduit pas automatiquement par une augmentation significative du nombre de médailles olympiques à long terme.

3. Facteurs Clés de la Durabilité (Confirmé par les recherches) :

Les recherches et études sur l'héritage olympique (par exemple, celles menées par le CIO ou des institutions universitaires) confirment ce constat : l'impact à long terme des Jeux est complexe et dépend moins de l'événement lui-même que de la capacité du pays à transformer cet élan en une stratégie sportive nationale durable.

Qualité des Structures Préexistantes : Un système sportif national fort, incluant des fédérations bien organisées, des centres d'entraînement performants, et des programmes de développement des jeunes talents, est un facteur déterminant.

Investissement Stratégique Post-Jeux : La manière dont les infrastructures et les fonds sont gérés après les Jeux est cruciale. Une réaffectation intelligente et un entretien continu des installations sont nécessaires.

Politiques Sportives Cohérentes : Les pays qui intègrent l'héritage olympique dans des politiques sportives nationales cohérentes et durables (développement de la base, soutien continu aux athlètes d'élite) ont de meilleures chances de voir une amélioration à long terme.

Contexte Économique et Social : La capacité d'un pays à capitaliser sur l'élan des Jeux est également influencée par sa situation économique, sa stabilité politique et l'engagement général de sa population dans le sport.

En conclusion, si l'accueil des Jeux Olympiques peut générer un pic de performance immédiat, l'impact sur la performance sportive à long terme est bien réel pour de nombreux pays, mais il est fortement modulé par leur niveau de développement structurel et leurs capacités d'investissement continu dans le sport de haut niveau. Ce défi de transformer un événement ponctuel en un bénéfice sportif durable est principalement relevé par les nations qui étaient déjà des forces sportives, capables de capitaliser sur l'élan olympique.

## 2. Existe-t-il une corrélation entre l'âge des athlètes et leur performance dans certaines disciplines

Nous cherchons à comprendre si l’âge des athlètes est un facteur clé de
leur performance, en particulier à travers l’obtention de médailles, et
si cette influence varie selon les disciplines sportives.

Nous partons de l’hypothèse que l'âge optimal de performance pourrait
différer selon les sports :\
- Dans des disciplines nécessitant puissance, vitesse et explosivité
(ex: gymnastique, natation), les athlètes seraient plus jeunes.\
- Tandis que dans des disciplines nécessitant technique, expérience ou
endurance mentale (ex: tir, équitation), les athlètes performants
seraient plus âgés.

### Question 1 : Âge moyen par sport

```{r echo=FALSE, message=FALSE, warning=FALSE}
# Lecture des données
athletes <- read_csv("data/Olympics Althlete Events Analysis/athlete_events.csv", show_col_types = FALSE)

# Nettoyage : ne garder que les athlètes ayant remporté une médaille
medalists <- athletes %>%
  filter(!is.na(Medal) & !is.na(Age)) 

# Regrouper par sport pour calculer l'âge moyen
age_by_sport <- medalists %>%
  group_by(Sport) %>%
  summarise(
    Mean_Age = mean(Age),
    Count = n()
  ) %>%
  ungroup()

# Sélectionner les 10 sports avec l'âge moyen le plus bas et les 10 avec l'âge moyen le plus élevé
age_top_bottom <- age_by_sport %>%
  arrange(Mean_Age) %>%
  slice_head(n = 10) %>%
  bind_rows(
    age_by_sport %>%
      arrange(desc(Mean_Age)) %>%
      slice_head(n = 10)
  )

# Visualisation
ggplot(age_top_bottom, aes(x = reorder(Sport, Mean_Age), y = Mean_Age)) +
  geom_col(fill = "#00BFC4") +
  coord_flip() +
  labs(
    title = "Âge moyen des médaillés (Top 10 plus jeunes et Top 10 plus âgés)",
    subtitle = "Analyse des Jeux Olympiques (1896-2020)",
    x = NULL,
    y = "Âge moyen"
  ) +
  theme_minimal(base_size = 12) +
  theme(
    plot.title = element_text(hjust = 0.5, face = "bold"),
    panel.grid.major.y = element_blank(),
    plot.title.position = "plot",
    plot.subtitle = element_text(hjust = 0.5)
  )
```

### Interprétation

Le graphique montre des différences marquées d'âge moyen selon les
disciplines :

-   Sports d'explosivité (ex: gymnastique, natation, plongeon) : Les
    athlètes ayant remporté des médailles sont très jeunes, avec un âge
    moyen souvent inférieur à 25 ans. Cela confirme l'idée que jeunesse
    et qualités physiques maximales (force, agilité, récupération
    rapide) sont déterminantes.
-   Sports d'adresse et d'expérience (ex: tir, équitation, roque) : Les
    médaillés sont sensiblement plus âgés, avec un âge moyen dépassant
    30 ans dans certaines disciplines. Ces sports nécessitent davantage
    de maîtrise technique, de calme, d'expérience et moins de dépendance
    à la performance physique brute.

Cela soulève cependant une autre question : Est-ce que la couleur de la
médaille remportée dépend de l'âge des athlètes ?

On pourrait s'attendre à ce que les trois athlètes montant sur le podium
(médailles d'or, d'argent et de bronze) soient globalement du même âge.

### Question 2 : Distribution âge par type de médaille

```{r echo=FALSE, message=FALSE, warning=FALSE}
# Définir des couleurs classiques pour les médailles
medal_colors <- c("Gold" = "#FFD700",    # Or
                  "Silver" = "#C0C0C0",  # Argent
                  "Bronze" = "#CD7F32")  # Bronze

# Visualiser la distribution de l'âge par type de médaille
ggplot(medalists, aes(x = Age, color = Medal)) +
  geom_density(alpha = 0.2, linewidth = 0.8) +
  scale_color_manual(values = medal_colors) +
  labs(
    title = "Distribution de l'âge selon le type de médaille remportée",
    subtitle = "Analyse des médaillés (JO été et hiver, 1896-2020)",
    x = "Âge",
    y = "Proportion d'athlètes",
    color = "Type de médaille",
    fill = "Type de médaille"
  ) +
  theme_minimal(base_size = 12) +
  theme(
    plot.title = element_text(hjust = 0.5, face = "bold"),
    plot.subtitle = element_text(hjust = 0.5),
    legend.position = "bottom",
    panel.grid.major.y = element_blank()
  )
```

### Interprétation

Le graphique présente la distribution de l'âge des athlètes médaillés
aux Jeux Olympiques (de 1896 à 2020) selon le type de médaille remportée
(bronze, argent, or).

On observe que : - La majorité des athlètes médaillés ont entre 20 et 30
ans, avec un pic autour de 23 ans. - La forme de la distribution est
très similaire pour les trois types de médailles : bronze, argent et or.

Le graphique suggère donc que, dans une même épreuve, les trois athlètes
présents sur le podium (médailles d'or, d'argent et de bronze) ont en
moyenne un âge similaire.

## 3. Disparités de genre

Nous cherchons ici à détecter et observer les disparités de genre au fil
de l'histoire des Jeux. On cherchera notamment à déterminer les facteurs
impactant ces disparités et leurs évolutions.

### Question 1 : Évolution des participations par sexe

```{r echo=FALSE, message=FALSE, warning=FALSE}
# On prends les athlètes ayant participé aux jeux d'été
summer_athletes_sex <- athletes %>%
  filter(Season == "Summer" )%>%
  group_by(Year) %>%
  count(Sex)

ggplot(summer_athletes_sex, aes(x = Year, y = n, fill = Sex)) +
  geom_bar(stat = "identity", position = "dodge") +
  labs(title = "Nombre d'hommes (M) et de femmes (F) athlètes par édition des jeux d'été") +
  theme_minimal()
```

### Interprétation

Le graphique dépeint l'évolution de la participation des hommes et
desfemmes aux jeux olympiques d'été. Deux éléments principaux en
ressortent :

1.  La part de femmes et systématiquement minoritaire de façon très
    nette.
2.  Le nombre d'athlètes féminines est en augmentation quasi constante,
    notamment sur les dernières années et ce même quand les hommes
    deviennent moins nombreux. En conséquent l'écart semble se réduire
    de façon quasiment constante.

Il semble également y avoir eu une grande accélération dans cette réduction des disparités entre les années 1980 et 2000. On peut aisément attribuer cette évolution à l'éveil des consciences et aux mouvements sociaux qui ont eu lieu à l'époque.

### Question 2 : Évolution des performances par sexe

```{r echo=FALSE, message=FALSE, warning=FALSE}
summer_medalists_sex <- medalists %>%
  filter(Season == "Summer" )%>%
  group_by(Year) %>%
  count(Sex)

ggplot(summer_medalists_sex, aes(x = Year, y = n, fill = Sex)) +
  geom_bar(stat = "identity", position = "dodge") +
  labs(title = "Nombre d'hommes (M) et de femmes (F) médaillés par édition des jeux d'été") +
  theme_minimal()
```

```{r echo=FALSE, message=FALSE, warning=FALSE}

summer_medals_sex <- medalists %>%
  filter(Season == "Summer" )%>%
  group_by(Year, Medal) %>%
  count(Sex, Medal)

ggplot(summer_medals_sex %>% filter(Medal == "Gold"), aes(x = Year, y = n, fill = Sex)) +
  geom_bar(stat = "identity", position = "dodge") +
  labs(title = "Nombre d'hommes (M) et de femmes (F) médaillés d'or par édition des jeux d'été") +
  theme_minimal()

ggplot(summer_medals_sex %>% filter(Medal == "Silver"), aes(x = Year, y = n, fill = Sex)) +
  geom_bar(stat = "identity", position = "dodge") +
  labs(title = "Nombre d'hommes (M) et de femmes (F) médaillés d'argent par édition des jeux d'été") +
  theme_minimal()

ggplot(summer_medals_sex %>% filter(Medal == "Bronze"), aes(x = Year, y = n, fill = Sex)) +
  geom_bar(stat = "identity", position = "dodge") +
  labs(title = "Nombre d'hommes (M) et de femmes (F) médaillés de bronze par édition des jeux d'été") +
  theme_minimal()
```

### Interprétation

La progression du nombre de médaillées féminines semble plus continue que l'augmentation d'athlètes féminines, particulièrement entre 1975 et 2000. On peut y voir une ouverture officielle des épreuves aux femmes qui a été continue tout en ayant une arrivée d'abord lente puis explosives des participants, ce qui s'explique avec le fait que dans les premières années de l'ouverture plus large des épreuves la participation des femmes était une chose moins acceptée et donc tentée. Une fois celle-ci acceptée les années suivantes ont vu la participation exploser pour ensuite se calquer petit à petit sur l'augmentation des épreuves.

Un autre point à relever est le fait qu'autant côté participation que médailles les femmes semblent atteindre un plateau depuis les années 2000 et même si la progression semble continuer elle est très limitée malgré l'écart restant avec les hommes, même si celui-ci est très nettement réduit par rapport au siècle précédent.
On pourrait supposer que l'arrêt d'augmentation des médailles féminines a pu limiter l'augmentation des participations féminines puisque celles-ci poursuivent une courbe plus croissante que les médailles.

Par ailleurs il semblerait que dans les éditions les plus récentes la disparité soit plus visible pour les médailles de bronze.

## 4.Performances indivduelles

Nous cherchons à comprendre quels sont les athlètes les plus titrés de l’histoire des Jeux Olympiques, et si leur réussite est influencée par la saison (été ou hiver), la discipline sportive, ou encore la période historique à laquelle ils ont concouru.Nous partons de plusieurs hypothèses:
1.  Certains sports offrent plus d’épreuves individuelles, ce qui permet aux athlètes d’accumuler un nombre plus important de médailles (ex : natation, gymnastique, ou biathlon).
2.  Les Jeux d’été, proposant un plus grand nombre de disciplines, pourraient mécaniquement compter plus de champions multi-médaillés.
3. Les athlètes les plus décorés apparaissent peut-être plus fréquemment dans des périodes récentes, en raison de l'augmentation du nombre d'épreuves ou de participations aux JO sur plusieurs éditions.

Pour y répondre, nous utiliserons deux types de visualisations :
- Un graphique en barres comparant les athlètes les plus titrés dans les Jeux d'été et d'hiver, avec une mise en évidence de leurs disciplines respectives.
- Un nuage de points représentant la distribution dans le temps des athlètes ayant obtenu le plus de médailles, afin d'observer leur répartition historique et potentiellement dégager une tendance chronologique

```{r echo=FALSE, message=FALSE, warning=FALSE}
# Lecture des données été
data <- read_csv("data/Olympics_124_years_Dataset/Athletes_summer_games.csv")

# Nettoyage et filtrage
data_medals <- data %>% 
  filter(!is.na(Medal) & Medal != "")

# Comptage des médailles par athlète
medals_by_athlete <- data_medals %>%
  group_by(Name, Sport, Medal) %>%
  summarise(count = n(), .groups = "drop") %>%
  pivot_wider(names_from = Medal, values_from = count, values_fill = 0) %>%
  mutate(total = rowSums(across(c(Gold, Silver, Bronze)))) %>%
  arrange(desc(total), desc(Gold)) %>%
  slice_head(n = 20) %>%
  mutate(Name_Sport = paste0(Name, " (", Sport, ")"))

# Passage en format long pour ggplot
medals_long <- medals_by_athlete %>%
  select(-total, -Name, -Sport) %>%
  pivot_longer(cols = c("Gold", "Silver", "Bronze"), names_to = "Medal_Type", values_to = "Count") %>%
  mutate(
    Medal_Type = factor(Medal_Type, levels = c("Gold", "Silver", "Bronze")),
    Name_Sport = reorder(Name_Sport, Count, FUN = sum)
  )

# Visualisation
ggplot(medals_long, aes(x = Count, y = Name_Sport, fill = Medal_Type)) +
  geom_col(position = "stack", width = 0.7) +
  scale_fill_manual(values = c("Gold" = "#FFD700", "Silver" = "#C0C0C0", "Bronze" = "#CD7F32")) +
  labs(
    title = "Les 20 athlètes les plus médaillés aux Jeux olympiques d'été",
    subtitle = "Répartition par type de médaille (et sport)",
    x = "Nombre de médailles",
    y = "Athlète (Sport)",
    fill = "Type de médaille"
  ) +
  theme_minimal(base_size = 12) +
  theme(plot.title = element_text(face = "bold"), legend.position = "bottom")

```
```{r echo=FALSE, message=FALSE, warning=FALSE}
# Lecture des données hiver
data <- read_csv("data/Olympics_124_years_Dataset/Athletes_winter_games.csv")

# Nettoyage et filtrage
data_medals <- data %>% 
  filter(!is.na(Medal) & Medal != "")

# Comptage des médailles par athlète
medals_by_athlete <- data_medals %>%
  group_by(Name, Sport, Medal) %>%
  summarise(count = n(), .groups = "drop") %>%
  pivot_wider(names_from = Medal, values_from = count, values_fill = 0) %>%
  mutate(total = rowSums(across(c(Gold, Silver, Bronze)))) %>%
  arrange(desc(total), desc(Gold)) %>%
  slice_head(n = 20) %>%
  mutate(Name_Sport = paste0(Name, " (", Sport, ")"))

# Passage en format long
medals_long <- medals_by_athlete %>%
  select(-total, -Name, -Sport) %>%
  pivot_longer(cols = c("Gold", "Silver", "Bronze"), names_to = "Medal_Type", values_to = "Count") %>%
  mutate(
    Medal_Type = factor(Medal_Type, levels = c("Gold", "Silver", "Bronze")),
    Name_Sport = reorder(Name_Sport, Count, FUN = sum)
  )

# Visualisation
ggplot(medals_long, aes(x = Count, y = Name_Sport, fill = Medal_Type)) +
  geom_col(position = "stack", width = 0.7) +
  scale_fill_manual(values = c("Gold" = "#FFD700", "Silver" = "#C0C0C0", "Bronze" = "#CD7F32")) +
  labs(
    title = "Les 20 athlètes les plus médaillés aux Jeux olympiques d'hiver",
    subtitle = "Répartition par type de médaille (et sport)",
    x = "Nombre de médailles",
    y = "Athlète (Sport)",
    fill = "Type de médaille"
  ) +
  theme_minimal(base_size = 12) +
  theme(plot.title = element_text(face = "bold"), legend.position = "bottom")

```
```{r echo=FALSE, message=FALSE, warning=FALSE}
# Chargement des deux jeux de données
summer <- read_csv("data/Olympics_124_years_Dataset/Athletes_summer_games.csv")
winter <- read_csv("data/Olympics_124_years_Dataset/Athletes_winter_games.csv")

# Ajout de la colonne "Season"
summer <- summer %>% mutate(Season = "Summer")
winter <- winter %>% mutate(Season = "Winter")

# Fusion des deux
all_data <- bind_rows(summer, winter)

# Filtrage pour les athlètes avec médailles
medals_data <- all_data %>%
  filter(!is.na(Medal) & Medal != "")

# Résumé par athlète
athlete_summary <- medals_data %>%
  group_by(Name, Season) %>%
  summarise(
    total_medals = n(),
    last_year = max(Year),
    .groups = "drop"
  ) %>%
  filter(total_medals >= 10)

# Visualisation
ggplot(athlete_summary, aes(x = last_year, y = total_medals, color = Season)) +
  geom_point(size = 3, alpha = 0.7) +
  scale_color_manual(values = c("Summer" = "#F8766D", "Winter" = "#00BFC4")) +
  labs(
    title = "Nombre de médailles en fonction de l'année de la dernière médaille",
    subtitle = "Athlètes avec au moins 10 médailles (Jeux d'été en jaune, Jeux d'hiver en bleu)",
    x = "Année de la dernière médaille",
    y = "Nombre total de médailles",
    color = "Saison"
  ) +
  theme_minimal(base_size = 14) +
  theme(legend.position = "bottom", plot.title = element_text(face = "bold"))

```

### Interpretation

Notre analyse met en lumière une forte concentration des athlètes les plus titrés dans quelques disciplines spécifiques. Aux Jeux d'été, la natation (35 épreuves à Paris 2024) et la gymnastique (18 épreuves artistiques) se distinguent : ces sports offrent de nombreuses opportunités de médailles, souvent accessibles à un même athlète lors d’une seule édition, contrairement à l’athlétisme où la spécialisation limite ce cumul. Du côté des Jeux d’hiver, ce sont le ski de fond (12 épreuves) et le patinage de vitesse (14 épreuves) qui dominent pour les mêmes raisons : formats répétitifs et participation multiple possible. On constate également que le nombre total de médailles d’été est nettement supérieur, ce qui s’explique par un programme bien plus riche (329 épreuves à Paris 2024 contre 109 en hiver).Sur le plan historique, les athlètes comptant au moins 10 médailles apparaissent majoritairement à partir des années 1950, en lien avec l’augmentation progressive du nombre d’épreuves : environ 150 épreuves en 1952, 195 en 1972, 271 en 2000, et 329 en 2024. Cette expansion du programme olympique a multiplié les occasions de médailles et favorisé l’émergence de palmarès impressionnants. Enfin, Michael Phelps reste l’athlète le plus décoré de l’histoire, avec 28 médailles, illustrant parfaitement les conditions favorables offertes par la natation pour bâtir un palmarès exceptionnel.

## 5. Evolution de la participation

Dans cette étude, nous nous intéressons à l’évolution de la participation aux Jeux Olympiques ainsi qu’aux performances des athlètes les plus titrés de leur histoire. Nous cherchons à comprendre comment le nombre d’athlètes et de pays participants a évolué au fil des éditions, en distinguant les Jeux d’été des Jeux d’hiver. En effet, la différence de participation entre ces deux saisons est significative, justifiant une analyse séparée.

Nous partons de plusieurs hypothèses. D’une part, nous supposons que le nombre de participants a globalement augmenté au fil du temps, notamment en raison de l’augmentation du nombre d’épreuves et de pays engagés. D’autre part, nous anticipons des variations liées à des événements extra-sportifs, comme des boycotts ou des conflits politiques, qui ont pu affecter certaines éditions.

```{r echo=FALSE, message=FALSE, warning=FALSE}
# Charger les données
data <- read_csv("data/Olympics Althlete Events Analysis/athlete_events.csv")

# Filtrer uniquement la saison Summer
summer_participants <- data %>%
  filter(Season == "Summer") %>%
  distinct(ID, Year, Season) %>%
  count(Year, name = "nb_participants")

# Récupérer les années des JO d'été (présentes dans le dataset)
jo_years <- sort(unique(summer_participants$Year))

# Tracer la courbe pour Summer avec ticks personnalisés sur l'axe x
ggplot(summer_participants, aes(x = Year, y = nb_participants)) +
  geom_line(color = "#F8766D", size = 1.2) +
  geom_point(color = "#F8766D") +
  scale_x_continuous(breaks = jo_years) +
  labs(
    title = "Nombre d'athlètes uniques par édition des Jeux Olympiques d'été",
    x = "Année",
    y = "Nombre d'athlètes uniques"
  ) +
  theme_minimal() +
  theme(
    axis.text.x = element_text(angle = 45, hjust = 1)  # incliner les labels pour mieux lire
  )



```

```{r echo=FALSE, message=FALSE, warning=FALSE}
# Charger les données
data <- read_csv("data/Olympics Althlete Events Analysis/athlete_events.csv")

# Filtrer uniquement la saison Winter
summer_participants <- data %>%
  filter(Season == "Winter") %>%
  distinct(ID, Year, Season) %>%
  count(Year, name = "nb_participants")

# Récupérer les années des JO d'été (présentes dans le dataset)
jo_years <- sort(unique(summer_participants$Year))

# Tracer la courbe pour Summer avec ticks personnalisés sur l'axe x
ggplot(summer_participants, aes(x = Year, y = nb_participants)) +
  geom_line(color = "#00BFC4", size = 1.2) +
  geom_point(color = "#00BFC4") +
  scale_x_continuous(breaks = jo_years) +
  labs(
    title = "Nombre d'athlètes uniques par édition des Jeux Olympiques d'hiver",
    x = "Année",
    y = "Nombre d'athlètes uniques"
  ) +
  theme_minimal() +
  theme(
    axis.text.x = element_text(angle = 45, hjust = 1)  # incliner les labels pour mieux lire
  )

```

### Interpretation

L’évolution du nombre de participants aux Jeux Olympiques d’été est globalement à la hausse au fil du temps, reflétant l’expansion du mouvement olympique et la multiplication des pays et disciplines représentés. Cependant, on observe trois baisses marquées en 1932, 1956 et 1980, qui s’expliquent principalement par des contextes historiques et géopolitiques spécifiques:

- 1932 (Los Angeles) : Cette édition a connu une forte baisse de participation liée à la Grande Dépression, une crise économique mondiale majeure qui a limité les moyens financiers des pays pour envoyer leurs athlètes à l’étranger, surtout aux États-Unis, éloignés géographiquement des principaux foyers olympiques européens.

- 1956 (Melbourne) : Plusieurs boycotts politiques ont affecté ces Jeux. La crise de Suez a conduit à l’absence de plusieurs pays arabes, tandis que l’intervention soviétique en Hongrie a provoqué des boycotts de la part de nations occidentales. De plus, la République populaire de Chine a refusé de participer en réaction à la présence de Taïwan. Ces tensions politiques ont donc diminué le nombre d’athlètes présents.

- 1980 (Moscou) : Ce fut l’année du boycott massif mené par les États-Unis et plusieurs de leurs alliés, en protestation contre l’invasion soviétique de l’Afghanistan. Ce boycott a provoqué une baisse importante du nombre de participants, surtout des pays occidentaux.

On remarque une évolution similaire pour les jeux d'hivers

```{r echo=FALSE, message=FALSE, warning=FALSE}


library(tidyverse)

data <- read_csv("data/Olympics Althlete Events Analysis/athlete_events.csv")

# Filtrer les équipes qui ressemblent à des pays
data_filtered <- data %>%
  filter(str_detect(Team, "^[A-Z][a-z]+(?:[ -][A-Z][a-z]+)*$"))

# Calculer le nombre de pays distincts par année et saison
countries_year_season <- data_filtered %>%
  distinct(Team, Year, Season) %>%
  count(Year, Season, name = "nb_pays")

# Transformer Year en facteur ordonné
countries_year_season <- countries_year_season %>%
  mutate(Year = factor(Year, levels = sort(unique(Year))))

# Choisir les années à afficher comme labels (par exemple tous les 8 ans)
years_to_label <- levels(countries_year_season$Year)[
  seq(1, length(levels(countries_year_season$Year)), by = 8)
]

ggplot(countries_year_season, aes(x = Year, y = nb_pays, fill = Season)) +
  geom_bar(stat = "identity", 
           position = position_dodge2(width = 0.9, preserve = "single"), 
           width = 0.4) +
  labs(
    title = "Nombre de pays participants aux Jeux Olympiques par édition (été vs hiver)",
    x = "Année",
    y = "Nombre de pays",
    fill = "Saison"
  ) +
  scale_fill_manual(values = c("Summer" = "#F8766D", "Winter" = "#00BFC4")) +
  scale_x_discrete(breaks = years_to_label) +
  theme_minimal() +
  theme(
    axis.text.x = element_text(angle = 45, hjust = 1)
  )





```

### Interpretation

Le nombre de pays participants aux Jeux Olympiques a fortement augmenté au fil du temps. Cela s’explique surtout par la décolonisation et l’indépendance de nombreux pays, ainsi que par l’ouverture du mouvement olympique à davantage de nations. On observe aussi que plus de pays participent aux Jeux d’été qu’aux Jeux d’hiver. Cela vient du fait que les sports d’hiver nécessitent des climats froids et des infrastructures spécifiques, ce qui limite la participation à certains pays seulement.
Pics et creux dans la participation

Certains pics dans le nombre de pays correspondent à des périodes historiques majeures. Par exemple, la fin de l’Union soviétique a vu l’apparition de nombreux nouveaux États participants. À l’inverse, des creux correspondent souvent à des boycotts politiques, comme en 1980 et 1984, où des groupes de pays ont refusé de participer en raison de tensions internationales.Enfin, les premières éditions des Jeux comptaient naturellement peu de pays, car le mouvement était alors plus restreint.

## 6. Analyse démographique

Dans cette section, nous nous intéressons aux caractéristiques physiques des athlètes olympiques, plus précisément à l’évolution de leur taille et de leur poids au fil du temps et selon les disciplines sportives.
Nous formulons l’hypothèse que les exigences physiques propres à chaque sport influencent fortement la morphologie moyenne des athlètes. Par exemple, nous nous attendons à ce que les disciplines de force (comme l’haltérophilie) présentent des athlètes plus lourds, tandis que les disciplines artistiques ou d’endurance (comme la gymnastique ou la course de fond) affichent des gabarits plus légers et/ou plus petits.
Nous supposons également que les standards physiques ont évolué au fil des décennies, en lien avec la professionnalisation croissante du sport et les avancées en matière de préparation physique.
Pour tester ces hypothèses, nous allons visualiser l’évolution de la taille moyenne et du poids moyen des athlètes par discipline et par année, à l’aide de line graphs. Ces visualisations permettront d’identifier les tendances globales ainsi que les différences entre sports.

```{r echo=FALSE, message=FALSE, warning=FALSE}
# Chargement des données
df <- read.csv("data/Olympics Althlete Events Analysis/athlete_events.csv")

# Nettoyage : retirer les valeurs manquantes
df_physique <- df %>%
  filter(!is.na(Height), !is.na(Weight), !is.na(Sport), !is.na(Year))

# Identifier les 6 sports les plus fréquents
top_sports <- df_physique %>%
  count(Sport, sort = TRUE) %>%
  top_n(6, n) %>%
  pull(Sport)

# Filtrer les données pour ne garder que ces sports
df_top_sports <- df_physique %>%
  filter(Sport %in% top_sports)

# Calcul des moyennes taille/poids par sport et par année
df_evolution <- df_top_sports %>%
  group_by(Year, Sport) %>%
  summarise(
    mean_height = mean(Height, na.rm = TRUE),
    mean_weight = mean(Weight, na.rm = TRUE),
    .groups = "drop"
  )

# Graphique : évolution de la taille moyenne
ggplot(df_evolution, aes(x = Year, y = mean_height, color = Sport)) +
  geom_line(size = 1.2) +
  labs(
    title = "Évolution de la taille moyenne des athlètes (6 disciplines principales)",
    x = "Année",
    y = "Taille moyenne (cm)",
    color = "Discipline"
  ) +
  theme_minimal()

# Graphique : évolution du poids moyen
ggplot(df_evolution, aes(x = Year, y = mean_weight, color = Sport)) +
  geom_line(size = 1.2) +
  labs(
    title = "Évolution du poids moyen des athlètes (6 disciplines principales)",
    x = "Année",
    y = "Poids moyen (kg)",
    color = "Discipline"
  ) +
  theme_minimal()
```


### Interprétation

Les graphiques montrent comment la taille et le poids moyens des athlètes évoluent selon les sports, en lien avec les exigences propres à chaque discipline. Par exemple, les rameurs sont généralement plus grands et plus lourds, ce qui correspond à la puissance nécessaire dans leur sport. À l’inverse, les gymnastes sont plus petits et légers, ce qui leur permet d’avoir un bon équilibre et de réaliser des mouvements techniques, avec une légère diminution de leur taille au fil du temps. Les nageurs, quant à eux deviennent de plus en plus grands, mais leur poids reste modéré pour faciliter la glisse dans l’eau. Les cyclistes et les skieurs de fond ont des tailles et des poids moyens plutôt stables, car ils ont besoin d’un équilibre entre endurance et puissance. Enfin, les athlètes en général montrent des valeurs assez constantes, probablement lié à la diversité des épreuves dans l’athlétisme nécessitant d'avoir un physique "hybride". En revanche on ne peut pas distinguer de tendance générale sur l'évolution du poids et de la taille des athlètes de manière générale au fil du temps.

## 7. Analyse des villes hôtes

Cette section examine la répartition géographique des villes ayant accueilli les Jeux Olympiques, afin d’identifier d’éventuels déséquilibres régionaux et leur évolution historique.
Nous partons de l’hypothèse que les pays du Nord (Europe, Amérique du Nord, Asie de l’Est) ont été surreprésentés, tandis que l’Afrique, l’Amérique latine et l’Asie du Sud ont été peu sollicitées.
Pour tester cette hypothèse, nous cartographierons les villes hôtes par année et type de Jeux (été/hiver), afin de repérer d’éventuelles concentrations géographiques et évaluer si la répartition s’est diversifiée avec le temps.

### Question 1 : Y a-t-il une tendance géographique dans le choix des villes hôtes au fil des années ?

Pour répondre à cette question, nous allons produire une carte du monde représentant les villes hôtes successives, avec un code couleur indiquant le type de Jeux (été/hiver) et une échelle de temps pour visualiser la chronologie. Cette visualisation permettra d’identifier s’il existe des zones privilégiées dans l’attribution des Jeux Olympiques, et si cette tendance évolue vers plus de diversité géographique au cours des décennies.

```{r echo=FALSE, message=FALSE, warning=FALSE}
# Chargement des bibliothèques nécessaires
library(dplyr)
library(ggplot2)
library(maps)
library(ggrepel)
library(tidygeocoder)

# Extraire la table des éditions des JO (une ville par année)
df_host_cities <- df %>%
  select(Year, City, Season, NOC) %>%
  distinct()

# Géocodage des villes pour obtenir les coordonnées géographiques
coords_villes <- df_host_cities %>%
  distinct(City) %>%
  geocode(City, method = "osm", lat = lat, long = lon)

# Joindre les coordonnées aux villes hôtes
df_host_geo <- df_host_cities %>%
  left_join(coords_villes, by = "City")

# Base de la carte du monde
world_map <- map_data("world")

# Visualisation : carte avec points colorés par saison et dégradé temporel
ggplot() +
  geom_map(data = world_map, map = world_map,
           aes(long, lat, map_id = region),
           color = "gray80", fill = "gray95", size = 0.3) +
  geom_point(data = df_host_geo,
             aes(x = lon, y = lat, color = Season, size = Year),
             alpha = 0.8) +
  geom_text_repel(data = df_host_geo,
                  aes(x = lon, y = lat, label = paste0(City, "\n", Year)),
                  size = 3, max.overlaps = 10) +
  scale_color_manual(values = c("Summer" = "#F8766D", "Winter" = "#00BFC4")) +
  scale_size_continuous(range = c(2, 6)) +
  theme_minimal() +
  labs(
    title = "Répartition géographique des villes hôtes des Jeux Olympiques",
    subtitle = "Couleur selon la saison (été / hiver) | Taille selon l’année",
    x = NULL, y = NULL,
    color = "Saison", size = "Année"
  ) +
  theme(panel.grid = element_blank())
```

### Interprétation
